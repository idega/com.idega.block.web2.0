!function(){var a={},b=function(b){for(var c=a[b],e=c.deps,f=c.defn,g=e.length,h=new Array(g),i=0;i<g;++i)h[i]=d(e[i]);var j=f.apply(null,h);if(void 0===j)throw"module ["+b+"] returned undefined";c.instance=j},c=function(b,c,d){if("string"!=typeof b)throw"module id must be a string";if(void 0===c)throw"no dependencies for "+b;if(void 0===d)throw"no definition function for "+b;a[b]={deps:c,defn:d,instance:void 0}},d=function(c){var d=a[c];if(void 0===d)throw"module ["+c+"] was undefined";return void 0===d.instance&&b(c),d.instance},e=function(a,b){for(var c=a.length,e=new Array(c),f=0;f<c;++f)e.push(d(a[f]));b.apply(null,b)},f={};f.bolt={module:{api:{define:c,require:e,demand:d}}};var g=c,h=function(a,b){g(a,[],function(){return b})};h("5",tinymce.util.Tools.resolve),g("1",["5"],function(a){return a("tinymce.dom.TreeWalker")}),g("2",["5"],function(a){return a("tinymce.PluginManager")}),g("3",["5"],function(a){return a("tinymce.util.Tools")}),g("4",["5"],function(a){return a("tinymce.util.VK")}),g("0",["1","2","3","4"],function(a,b,c,d){return b.add("textpattern",function(b){function e(){return m&&(l.sort(function(a,b){return a.start.length>b.start.length?-1:a.start.length<b.start.length?1:0}),m=!1),l}function f(a){for(var b=e(),c=0;c<b.length;c++)if(0===a.indexOf(b[c].start)&&(!b[c].end||a.lastIndexOf(b[c].end)==a.length-b[c].end.length))return b[c]}function g(a,b,c){var d,f,g;for(d=e(),g=0;g<d.length;g++)if(f=d[g],f.end&&a.substr(b-f.end.length-c,f.end.length)==f.end)return f}function h(a){function c(){i=i.splitText(k),i.splitText(j-k-o),i.deleteData(0,n.start.length),i.deleteData(i.data.length-n.end.length,n.end.length)}var d,e,h,i,j,k,l,m,n,o,p;if(d=b.selection,e=b.dom,d.isCollapsed()&&(h=d.getRng(!0),i=h.startContainer,j=h.startOffset,l=i.data,o=a?1:0,3==i.nodeType&&(n=g(l,j,o),n&&(k=Math.max(0,j-o),k=l.lastIndexOf(n.start,k-n.end.length-1),k!==-1&&(m=e.createRng(),m.setStart(i,k),m.setEnd(i,j-o),n=f(m.toString()),n&&n.end&&!(i.data.length<=n.start.length+n.end.length))))))return p=b.formatter.get(n.format),p&&p[0].inline?(c(),b.formatter.apply(n.format,{},i),i):void 0}function i(){var d,e,g,h,i,j,k,l,m,n,o;if(d=b.selection,e=b.dom,d.isCollapsed()&&(k=e.getParent(d.getStart(),"p"))){for(m=new a(k,k);i=m.next();)if(3==i.nodeType){h=i;break}if(h){if(l=f(h.data),!l)return;if(n=d.getRng(!0),g=n.startContainer,o=n.startOffset,h==g&&(o=Math.max(0,o-l.start.length)),c.trim(h.data).length==l.start.length)return;l.format&&(j=b.formatter.get(l.format),j&&j[0].block&&(h.deleteData(0,l.start.length),b.formatter.apply(l.format,{},h),n.setStart(g,o),n.collapse(!0),d.setRng(n))),l.cmd&&b.undoManager.transact(function(){h.deleteData(0,l.start.length),b.execCommand(l.cmd)})}}}function j(){var a,c;c=h(),c&&(a=b.dom.createRng(),a.setStart(c,c.data.length),a.setEnd(c,c.data.length),b.selection.setRng(a)),i()}function k(){var a,c,d,e,f;a=h(!0),a&&(f=b.dom,c=a.data.slice(-1),/[\u00a0 ]/.test(c)&&(a.deleteData(a.data.length-1,1),d=f.doc.createTextNode(c),a.nextSibling?f.insertAfter(d,a.nextSibling):a.parentNode.appendChild(d),e=f.createRng(),e.setStart(d,1),e.setEnd(d,1),b.selection.setRng(e)))}var l,m=!0;l=b.settings.textpattern_patterns||[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}],b.on("keydown",function(a){13!=a.keyCode||d.modifierPressed(a)||j()},!0),b.on("keyup",function(a){32!=a.keyCode||d.modifierPressed(a)||k()}),this.getPatterns=e,this.setPatterns=function(a){l=a,m=!0}}),function(){}}),d("0")()}();